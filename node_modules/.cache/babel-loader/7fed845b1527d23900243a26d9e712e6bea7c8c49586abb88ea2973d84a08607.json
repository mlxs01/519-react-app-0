{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sun/Dropbox/My Mac (Michelles-Air)/Desktop/BU/2023/diagnostic-test-mlxs01/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sun/Dropbox/My Mac (Michelles-Air)/Desktop/BU/2023/diagnostic-test-mlxs01/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/sun/Dropbox/My Mac (Michelles-Air)/Desktop/BU/2023/diagnostic-test-mlxs01/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Grid from\"@mui/material/Unstable_Grid2\";import{Select,Typography,MenuItem}from\"@mui/material\";/**\n * You will find globals from this file useful!\n */import{MY_BU_ID,BASE_API_URL,SEMESTER,GET_DEFAULT_HEADERS}from\"./globals\";import GradeTable from\"./components/GradeTable\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){// You will need to use more of these!\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),currClassId=_useState2[0],setCurrClassId=_useState2[1];// Ever changing\nvar _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),currClassName=_useState4[0],setCurrClassName=_useState4[1];// Based on what User clicks\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),currData=_useState6[0],setData=_useState6[1];// Holds the data for Data Table\nvar _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),allGrades=_useState8[0],setGrades=_useState8[1];// All the grades for that class\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),allClassIds=_useState10[0],setClassIds=_useState10[1];// const on load in\nvar _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),allClassNames=_useState12[0],setClassNames=_useState12[1];// const on load in\nvar _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),currFilteredStudents=_useState14[0],setFilteredStudents=_useState14[1];// All students for currClass\nvar _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),currStudentNames=_useState16[0],setStudentNames=_useState16[1];// To get each student's grades\nvar _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),currFilteredAssignments=_useState18[0],setFilteredAssignments=_useState18[1];// currClass's assignments' weight\nvar _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),isLoading=_useState20[0],setIsLoading=_useState20[1];//loading\n/**\n   * This is JUST an example of how you might fetch some data(with a different API).\n   * As you might notice, this does not show up in your console right now.\n   * This is because the function isn't called by anything!\n   *\n   * You will need to lookup how to fetch data from an API using React.js\n   * Something you might want to look at is the useEffect hook.\n   *\n   * The useEffect hook will be useful for populating the data in the dropdown box.\n   * You will want to make sure that the effect is only called once at component mount.\n   *\n   * You will also need to explore the use of async/await.\n   *\n   */useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var classListResponse,classListData,classIds,classNames;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"\".concat(BASE_API_URL,\"/class/listBySemester/\").concat(SEMESTER,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 2:classListResponse=_context.sent;_context.next=5;return classListResponse.json();case 5:classListData=_context.sent;// Pull out class Ids and class Names\nclassIds=classListData.map(function(item){return item.classId;});classNames=classListData.map(function(item){return item.title;});setClassIds(classIds);setClassNames(classNames);case 10:case\"end\":return _context.stop();}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData().then(function(){setIsLoading(false);});},[]);useEffect(function(){if(currClassId!==\"\"){//console.log(currClassId, currClassName);\nvar fetchStudents=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res,json;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"\".concat(BASE_API_URL,\"/class/listStudents/\").concat(currClassId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 2:res=_context2.sent;_context2.next=5;return res.json();case 5:json=_context2.sent;setFilteredStudents(json);case 7:case\"end\":return _context2.stop();}},_callee2);}));return function fetchStudents(){return _ref2.apply(this,arguments);};}();var fetchAssignments=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var res,json,filteredValues;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"\".concat(BASE_API_URL,\"/class/listAssignments/\").concat(currClassId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 2:res=_context3.sent;_context3.next=5;return res.json();case 5:json=_context3.sent;filteredValues=json.map(function(item){return item.weight;});setFilteredAssignments(filteredValues);case 8:case\"end\":return _context3.stop();}},_callee3);}));return function fetchAssignments(){return _ref3.apply(this,arguments);};}();// Fetch students and assignments\nfetchStudents().then(function(){return fetchAssignments();});}},[currClassId,currClassName]);useEffect(function(){// Since setFilteredAssignments happens after fetchStudents\n// Runs when students avail\n//console.log(\"filtered students:\", currFilteredStudents);\nif(currFilteredStudents.length>0&&currFilteredAssignments.length>0){var fetchAndSetGrades=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var grades;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return calcAllGrades();case 2:grades=_context4.sent;setGrades(grades);case 4:case\"end\":return _context4.stop();}},_callee4);}));return function fetchAndSetGrades(){return _ref4.apply(this,arguments);};}();var fetchStudentNamesAndSetNames=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var studentNames;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return Promise.all(currFilteredStudents.map(fetchStudentNames));case 2:studentNames=_context5.sent;setStudentNames(studentNames);case 4:case\"end\":return _context5.stop();}},_callee5);}));return function fetchStudentNamesAndSetNames(){return _ref5.apply(this,arguments);};}();// Fetch and set student names\nfetchStudentNamesAndSetNames().then(function(){// After setting student names, fetch and set grades\nfetchAndSetGrades();});}},[currFilteredAssignments]);useEffect(function(){// Runs after new student grades are avail\nif(allGrades.length>0){// Update student data here\nvar updatedStudentData=allGrades.map(function(grade,index){var studentId=currFilteredStudents[index];var studentName=currStudentNames[index];return createData(studentId,studentName,currClassId,currClassName,SEMESTER,grade);});setData(updatedStudentData);setIsLoading(false);}},[allGrades]);var fetchStudentNames=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(student){var res,json,filteredData;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(\"\".concat(BASE_API_URL,\"/student/GetById/\").concat(student,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 2:res=_context6.sent;_context6.next=5;return res.json();case 5:json=_context6.sent;filteredData=json[0].name;return _context6.abrupt(\"return\",filteredData);case 8:case\"end\":return _context6.stop();}},_callee6);}));return function fetchStudentNames(_x){return _ref6.apply(this,arguments);};}();var fetchStudentGrades=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(student){var res,json,gradesObject,gradeValues;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return fetch(\"\".concat(BASE_API_URL,\"/student/listGrades/\").concat(student,\"/\").concat(currClassId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 2:res=_context7.sent;_context7.next=5;return res.json();case 5:json=_context7.sent;gradesObject=json.grades[0];// convert the strings into numbers, because for some reason grades are strings\ngradeValues=Object.values(gradesObject).map(Number);return _context7.abrupt(\"return\",gradeValues);case 9:case\"end\":return _context7.stop();}},_callee7);}));return function fetchStudentGrades(_x2){return _ref7.apply(this,arguments);};}();function calcAllGrades(){return _calcAllGrades.apply(this,arguments);}function _calcAllGrades(){_calcAllGrades=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){var grades,gradePromises,gradeResults;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:grades=[];gradePromises=currFilteredStudents.map(function(student){return fetchStudentGrades(student);});_context8.next=4;return Promise.all(gradePromises);case 4:gradeResults=_context8.sent;gradeResults.forEach(function(gradeValues){var grade=calcGrade(gradeValues,currFilteredAssignments);grades.push(grade);});//console.log(\"All grades calculated:\", grades);\nreturn _context8.abrupt(\"return\",grades);case 7:case\"end\":return _context8.stop();}},_callee8);}));return _calcAllGrades.apply(this,arguments);}function calcGrade(grades,weight){var summing=grades.reduce(function(accumulator,currentValue,index){var product=currentValue*~~(weight[index]/100);//without ~~ grade can become nonterminating decimal\nreturn accumulator+product;},0);return summing;};function createData(// Creates data for Data Table\nstudentId,studentName,classId,className,semester,finalGrade){return{studentId:studentId,studnetName:studentName,classId:classId,className:className,semester:semester,finalGrade:finalGrade};}return/*#__PURE__*/_jsx(\"div\",{style:{width:\"100vw\",height:\"100vh\"},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,style:{padding:\"1rem\"},children:[/*#__PURE__*/_jsx(Grid,{xs:12,container:true,alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h2\",gutterBottom:true,children:\"Spark Assessment\"})}),/*#__PURE__*/_jsxs(Grid,{xs:12,md:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Select a class\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\"},children:/*#__PURE__*/_jsx(Select,{fullWidth:true,label:\"Class\",value:currClassName,onChange:function onChange(event){var selectedClassName=event.target.value;// Get the selected class name\nvar selectedIndex=allClassNames.indexOf(selectedClassName);// Find the index\nif(selectedIndex!==-1){setIsLoading(true);setCurrClassId(allClassIds[selectedIndex]);// Update class Id and Name\nsetCurrClassName(selectedClassName);}},children:allClassNames.map(function(className,index){return/*#__PURE__*/_jsx(MenuItem,{value:className,children:className},index);})})})]}),/*#__PURE__*/_jsxs(Grid,{xs:12,md:8,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Final Grades\"}),isLoading?/*#__PURE__*/_jsx(\"div\",{children:\"Loading data...\"}):\"\",/*#__PURE__*/_jsx(GradeTable,{studentData:currData})]})]})});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}